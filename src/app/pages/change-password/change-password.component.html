<main>
  <mat-toolbar color="primary">
    <mat-toolbar-row>
      <span class="title-center">Mudar a senha</span>
    </mat-toolbar-row>
  </mat-toolbar>

  <mat-dialog-content>
    <form [formGroup]="changePasswordForm">
      <section>
        <mat-form-field appearance="outline">
          <mat-label>Senha anterior</mat-label>
          <input matInput formControlName="oldPassword" type="password" />
          <mat-icon matSuffix>vpn_key</mat-icon>
          @if (changePasswordForm.controls.oldPassword.touched &&
          changePasswordForm.controls.oldPassword.invalid) {<mat-error>
            @if (changePasswordForm.controls.oldPassword.errors.required) {
            <span>Senha anterior é obrigatória</span>
            } </mat-error
          >}
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Nova senha</mat-label>
          <input matInput formControlName="newPassword" type="password" />
          <mat-icon matSuffix>lock_person</mat-icon>
          @if (changePasswordForm.controls.newPassword.touched &&
          changePasswordForm.controls.newPassword.invalid) {<mat-error>
            @if (changePasswordForm.controls.newPassword.errors.required) {
            <span>Digite sua nova senha!</span>
            } </mat-error
          >}
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Confirmação de senha</mat-label>
          <input matInput formControlName="confirmPassword" type="password" />
          <mat-icon matSuffix>lock_person</mat-icon>
          @if (changePasswordForm.controls.confirmPassword.touched &&
          changePasswordForm.controls.confirmPassword.invalid) {<mat-error>
            @if (changePasswordForm.controls.confirmPassword.errors.required) {
            <span>Confirme sua senha</span>}
          </mat-error>
          } @if ( validateSubmit() &&
          !(changePasswordForm.controls.confirmPassword.invalid)) {<mat-hint>
            As senhas não coincidem </mat-hint
          >}
        </mat-form-field>
      </section>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="center">
    <button mat-raised-button color="primary" type="submit" (click)="handleChangePasswordSubmit()" [disabled]="validateSubmit() || !(changePasswordForm.valid && changePasswordForm.dirty)">Trocar senha</button>
    <button mat-raised-button color="warn" mat-dialog-close>Fechar</button>
</mat-dialog-actions>
</main>
